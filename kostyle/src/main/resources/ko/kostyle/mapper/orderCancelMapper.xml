<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ko.kostyle.mapper.OrderCancelMapper"> <!-- 고유한 도메인 -->

	<insert id="insertOrderCancel" parameterType="ko.kostyle.domain.OrderCancelVO">
		<selectKey keyProperty="ocno" order="BEFORE"
			resultType="long">
			select ocno_seq.nextval from dual
		</selectKey>
		insert into order_cancel
		values(#{ocno}, #{odno}, #{category}, #{reason}, sysdate)
	</insert>
	
	<select id="orderCancelList" resultType="ko.kostyle.domain.OrderCancelVO">
		select * from order_cancel order by ocno desc
	</select>
	
	<select id="orderCancelDetail" resultType="ko.kostyle.domain.OrderCancelVO">
		select * from order_cancel where ocno = #{ocno}
	</select>
	
	<select id="productDetail" resultType="ko.kostyle.domain.ProductVO">
		select * from product where pno =
		(select pno from order_detail where odno = #{odno})
	</select>
	
	<update id="updateOrderPrice">
		update orders set totalprice = totalprice - #{price} where ono = #{ono}
	</update>

</mapper>

